PWR(Power Control),电源控制，负责管理STM32内部的电源供电部分，可实现可编程电压监测器和低功耗模式的功能。

可编程电压检测器(PVD),可以监控VDD电源电压，当VDD下降到PVD阈值以下或者上升到PVD阈值以上时，PVD会触发中断，用于执行紧急关闭任务。

低功耗模式，包括睡眠模式(Sleep),停机模式(Stop)和待机模式(Standby),可在系统空闲时，降低STM32的功耗，延长设备使用时间。

低功耗模式下，需要保留必要唤醒电路：串口接收数据的中断唤醒，外部中断唤醒，RTC闹钟唤醒。

VDDA供电区域：A/D转换器，温度传感器，复位模块，PLL锁相环。供电负极是VSSA。其中AD转换器还有VREF+和VREF-两个参考电压引脚，在引脚多的型号会单独引出来，引脚少的型号比如c8t6，在内部分别接到了VDDA和VSSA上了。
VDD供电区域，包括IO电路，待机电路，唤醒逻辑，独立看门狗,电压调节器。右边区域是VDD通过电压调解器，降压到1.8V，提供给1.8V供电区域，包括CPU核心，存储器，和内置数字外设。
电压调节器：作用是给1.8V区域供电，开就供电。内有低电压检测器，控制后备供电区域：VDD有电时，后备区域由VDD供电，VDD没电时，由VBAT供电。
STM32内部的大部分关键电路(CPU,存储器和外设)其实都是以1.8V的低电压运行的，当这些外设需要与外设进行交流时，才会通过IO电路转换到3.3V。
使用低电压运行的主要目的是降低功耗，电压越低，内部电路运行的功耗就像都越低。
VBAT后备供电区域：其中包括LSE 32K晶体振荡器，后备寄存器，RCC BDCR寄存器(备份域控制寄存器)和RTC。
上电复位和掉电复位：当VDD或者VDDA电压过低时，内部电路直接产生复位，让STM32复位住，不乱操作。
接上：复位和不复位界限之间设置了一个40mV的迟滞电压，大于上限POR(Power On Reset)时解除复位, 小于PDR(Power Down Reset)时复位。
接上：设置两个阈值作用：防止电压在某个阈值附近波动时，造成输出也来回抖动。复位信号(状态):低电平有效，电压过低时，复位。超过POW时不立即解除复位，而是有一个滞后时间，滞后时间后还能超过POW才会解除复位，这个滞后时间一般为2.5ms。
可编程电压检测器：阈值电压可以通过程序指定，有100mV迟滞(施密特触发)，可选范围(下降沿)(上升沿为下降沿+100mV)：2V~2.9V。有PVD输出，电压过低时为1，正常为0，可以申请中断，上升沿或者下降沿触发，以此提醒程序正当处理。如果要使用中断，记得要配置(EXTI)外部中断.
只有外部中断可以唤醒停止模式，其他设备可以通过借道外部中断来实现。
模式：睡眠，停机，待机，从左到右关闭的电路越来越多，越来越省电，越来越难唤醒 
  睡眠模式：调用WFI(Wait For Interrupt)或者WFE(Wait For Event)即可进入，这两个是内核的指令,唤醒条件(停机模式也是)是任一NVIC相应的中断(WFI),唤醒事件(WFE)。
进入睡眠模式就是吧CPU时钟关了，程序暂停，对其他时钟和ADC时钟无影响。CPU不运行，芯片功耗就会降低。电压调节器开，意思就给1.8v区域供电。
睡眠模式还可再细分：标志位SLEEPONEXIT=0，立刻睡眠，SLEEPONEXIT=1，等待当前中断处理完成再睡眠。(只要不在中断中调用WFI或WFE，其实效果一样)。
执行完WFI/WFE指令后，STM32进入睡眠模式，程序暂停运行，唤醒后程序从暂停的地方继续运行(所有模式都这样)。睡眠模式下，所有IO口都保持睡眠前的状态(停机模式也是).
  ~关闭电路通常有两个做法：关闭时钟和关闭电源。关闭时钟，所有操作和设计时序的操作都会暂停，但是寄存器和存储器里保存的数据还可以维持；关闭电源，直接断电，电路操作和数据直接丢失。
  停机模式：SLEEPDEEP=1，进入深度睡眠模式，PDDS=0进入停机模式。电压调节器开启或处于低功耗模式(LPDS(设置电压调节器)=0，电压调节器开启，LPDS=1)，电压调节器进入低功耗模式。当把这些位提前设置好了，最后调用WFI或者WFE进入停机模式。唤醒条件是任一外部中断(PVD,RTC闹钟，USB唤醒，ETH唤醒借道了外部中断，这四个模式也可以唤醒停止模式)。此模式影响是：关闭所有1.8V区域时钟，就是CPU不能运行，外设也不运行(定时器不计数，串口也不收发)，CPU和外设寄存器的数据维持原状。PLL,HSI和HSE的振荡器关闭。
停机模式结束后，并不会自动帮我们开启PLL和HSE，而是默认用HSI的8MHz作为主频。所以一般在停止模式唤醒后，第一时间重新启动HSE，配置主频为72MHz。
当电压调节器处于低功耗模式下，会有一段额外的启动延时。
  待机模式：SLEEPDEEP=1，进入深度睡眠模式，PDDS=1进入待机模式。唤醒方式：WKUP引脚的上升沿，RTC的闹钟时间，NRST引脚上的外部复位(复位键也可以唤醒)，IWDG独立看门狗复位。影响：1.8V区域断电，HSI和HSE的振荡器关闭。配合RTC和独立看门狗的低速时钟正常工作。备份寄存器和待机电路维持供电。所有IO引脚变为高阻态(不管灯什么要求都熄灭)(不留过电流)(浮空输入).唤醒后程序从头开始运行。
~~主频越低，耗电越低，主频降低一半，耗电降低一半(不严格对应)
睡眠模式耗电：50mA(最大，设备开满了的情况)降到30mA
停机和待机耗电：30mA->30uA(停机)->3uA(待机)
备份区供电：1.4uA(RTC开启)
