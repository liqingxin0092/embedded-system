续纸质笔记:

1.有一些常用命令,见图片.

发送ACMD前要发送CMD55.

命令的参数具体是多少要查阅PDF

询问电压支持情况和SD卡容量是很重要.

一般情况下,写之前,SD卡自动检测是否需要擦除,需要就擦了.

有个命令是预先擦除,不用它SD卡也会自动擦除,这个命令是加速的.

2.SD卡响应.

SD卡和单片机的通信采用发送应答机制.

每发送一个命令,SD卡都会给出一个应答,以告知主机该命令的执行情况,或者返回主机需要获取的数据.使用SDIO接口时,响应通过CMD线传输.

SD卡响应因使用接口不同,格式也不同.响应具体由R1,R1b,R2,R3,R7.

响应内容大小可以分为48bit和136bit.

具体见图:响应.

3.不同命令响应可能一样,如何区分响应的是那条命令?
R1:[45:40]6位可区分,command index,具体见图.

4.R6响应,获取SD卡相对地址. SPI模式没有RCA寄存器,也不支持CMD3命令,没有R6响应.
