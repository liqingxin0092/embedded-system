 介绍: DS18B20是一种常见的数字温度传感器,内部将温度的模拟量转化为数字量存放于RAM中供用户读取.

 测温范围: -55 ~ 125 摄氏度.

 通信接口: 单总线(DQ).

 其他特征: 可形成总线结构,内置温度报警功能,可寄生供电(VCC都省了,数据线和GND就能通信).

 *寄生供电: 数据线高电平时可以供电,同时给个电容充电;数据线低电平时,电容供电. 单总线上的上拉电阻要稍微小些.

 封装:TO92,像三极管.

 存在64bit ROM,存放唯一ID.用于总线寻址.

 存在scratch pad(暂存器):用于总线的数据交互.

 EEPROM:用于保存温度出发阈值和参数.

 带CRC校验.

 以下介绍单总线结构:

 异步,半双工.

 时序部分:

 初始化:主机将总线拉低至少480us后释放总线,等待15~60us后,存在的从机会拉低总线60~240us以响应主机,之后从机释放总线.
 
 发送一位:主机将总线拉低60~120us,然后释放总线,表示发送0.主机将总线拉低1~15us,然后释放总线,表示发送1.从机价格在总线拉低30us(典型值)后读取电平,整个时间片应大于60us.

 接收一位:主机将总线拉低1~15us,然后释放总线,并在拉低后15us内读取总线电平(尽量贴近15us的末尾),读取低电平则为0,高电平则为1,整个时间片应该大于60us.

 发送/接收一个字节:连续调用8次发送/接收一位的函数.低位先行.

 DS18B20操作流程.

 1.初始化:从机复位,主机判断从机是否响应.
 2.ROM:ROM指令+本指令需要的读写操作.
 3.功能操作:功能指令+本指令需要的读写操作.

 SEARCH_ROM:F0h 
 READ_ROM:33h
 MATCH_ROM:55h
 SKIP_ROM:CCh
 ALARM_SEARCH:ech

 CONVERT:44h
 WRITE_SCRATCHPAD:4eh
 READ_SCRATCHPAD:BEh
 COPY_SCRATCHPAD:48h
 RECALL_E2:B8h
 READ_POWER_SUPPLY:B4h
 
